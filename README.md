# Multimodal inter-subject correlation analysis
Can shared affective processes of two individuals be tracked down by brain-body intersubject correlations (ISC)? What types of shared processes lie beyond normative measuring of ISC in brain signals (Brain-ISC)? We propose a complementary approach to investigating brain-body synchronization in response to audiovisual narratives by analyzing multimodal recordings from six subjects who watched four seasons of the Friends TV show over 14 hours. We asked whether consistent cardiac activity assessed using heart-rate ISC (HR-ISC) yields localized synchronization in emotional areas of the brain in each pair of subjects. 

ISC analyses of brain (functional magnetic resonance imaging; fMRI) and cardiac (photoplethysmography; PPG) activity were carried out in the context of a free viewing task included in the Courtois-Neuromod project (Boyle et al., 2021).  Univariate temporal ISC were used to estimate the degree of synchronization specific to each pair of individuals. 

Our results are in line with the literature in showing a distinctive level of  Brain-ISC for sensory and non-sensory areas (Kauppi et al., 2010; Nastase et al., 2019; Qi et al., 2018). Moreover, subjects showed a substantial level of cardiac synchronization as nonparametric hypothesis testing reports average HR-ISC is larger than zero. Modeling the variability of Brain-ISC and HR-ISC in specific pairs of subjects suggests that cardiac synchronization does not linearly coincide with temporally stable nor localized synchronization in the brain. On this ground, we suggest that subjects submitted to the same audiovisual narrative might not synchronize as they access a shared “cognitive representation” (Madsen et al., 2022), but rather as they perform similar “mental actions” (Sandved-Smith et al., 2021).

## Brain-ISC

![pairgrid_brain-isc](https://github.com/courtois-neuromod/flesp_friends-isc/assets/38385719/c4b4b87e-5580-4ed7-b762-23d42ad30278)
Brain-ISC. Univariate temporal ISC were computed on voxel-based brain volumes (MNI 152 anatomical template). Pearson r correlation values are represented by the color scale and thresholded at r=0.15. Panel A shows 4 views of the same voxel-based univariate ISC image, averaged across all segments and pairs of subjects. Panel B shows a pairgrid of the same 4 views ISC images, averaged across segments for each pair of subjects. The diagonal shows the average across all pairs involving a given subject. 

High ISC across pairs and segments in occipital and temporal cortices during video watching. Pairs of subjects appear to have qualitative differences across average Brain-ISC maps.

## HR-ISC

![pairgrid_hr-isc_diagonal_hypotesting](https://github.com/courtois-neuromod/flesp_friends-isc/assets/38385719/cb47c417-a70b-4352-a746-bc19475c362a)

The empirical HR-ISC average and confidence intervals (at 95%) across all observations are represented by the red vertical lines, while the distribution of 100 bootstrapped average computed from unrelated segments is shown by the kernel density estimate drawn in blue (confidence intervals at 95% are indicated by vertical lines) on Panel A. The HR-ISC pairgrid (of panel B) shows a smoothed kernel density estimate (KDE), using the same scale on the y-axis of each plot. HR-ISC values (Pearson r correlation coefficient) are placed on the x-axis, ranging from r=-1 to r=1. The empirical distribution of each pair of participants is presented on the pairgrid, where the average of all pairs involving a given subject is on the diagonal. The white box inside each KDE plot corresponds to the null distribution associated with each pair and subject, to which the empirical values are compared (FDR, alpha=0.05). The blue line represents the KDE associated with the null. Green boxes report a significant departure from the null, while red boxes show non-significant differences. The percentile associated with the determined threshold of 80% of values in the null distribution (indicated by the dashed white line), as well as the number of segments over that threshold in the empirical distributions are indicated on the top right corner of each plot. 

Average HR-ISC across all observations is small but significant. Precisely, a hundred iterations of time series shuffling were used to perform non-parametric hypothesis testing. To test whether ISC was present in cardiac activity, the empirical average HR-ISC and its confidence intervals across all segments and pairs were compared to the 100 bootstrapped averages (seen in Figure 3A).

## Methods
![method_prep_imgs](https://github.com/courtois-neuromod/flesp_friends-isc/assets/38385719/22212c0b-b3e1-4723-ae71-23be1902c119)
Data preparation and design. The figure presents the separate preparation workflows for the two modalities. On the left, biosignals are segmented and converted in BIDS format (pre-processing), then the processing workflow of the PPG is broken down into main steps. All panels consider the same 20 seconds segment. Panel A shows the raw signal, while B shows the bandpassed (0.5Hz-8Hz). Panel C shows the detected systolic peaks. Panel D shows the threshold signal in orange and the purple shaded area of detection. Panel E shows the HR signal resulting from the artifact correction algorithm (in orange) compared to the one resulting from the initial peak detection procedure (in blue). On the right, BOLD signals are preprocessed using fmriprep standardized pipeline. Then, Nilearn is used to apply further corrections using the load confounds strategy. The BOLD signals can either be projected into anatomical or DiFuMo space for analysis. Corrected time series from both modalities can be subjected to ISC analyses separately, or together for GLM modeling (Multimodal ISC). HR time series are interpolated from corrected pulse intervals to the BOLD sampling rate. Both modalities are segmented in non-overlapping windows of 45 seconds. Univariate ISC values are computed for each time window.
